<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xmlns:si="http://www.springframework.org/schema/integration"
       xsi:schemaLocation="http://www.springframework.org/schema/beans
			http://www.springframework.org/schema/beans/spring-beans.xsd
			http://www.springframework.org/schema/integration
			http://www.springframework.org/schema/integration/spring-integration.xsd">

    <si:channel id="payments"/>

    <si:channel id="invoices">
       <si:queue/>
    </si:channel>

    <si:channel id="credit-card-payments"/>

    <si:channel id="paypal-payments">
       <si:queue/>
    </si:channel>

    <si:router method="routePaymentSettlement" input-channel="payments">
        <bean class="com.manning.siia.integration.routing.PaymentSettlementRouter"/>
    </si:router>

    <si:channel id="visa-payments">
       <si:queue/>
    </si:channel>

    <si:channel id="american-express-payments">
       <si:queue/>
    </si:channel>

    <si:channel id="mastercard-payments">
       <si:queue/>
    </si:channel>


    <si:router expression="payload.creditCardType" channel-resolver="creditCardPaymentsChannelResolver" input-channel="credit-card-payments"/>

    <bean id="creditCardPaymentsChannelResolver" class="com.manning.siia.integration.routing.CreditCardPaymentChannelResolver"/>

</beans>